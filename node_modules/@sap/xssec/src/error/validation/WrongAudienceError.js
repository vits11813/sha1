const TokenValidationError = require("./TokenValidationError");

class WrongAudienceError extends TokenValidationError {
    /** @type {string[]} token audiences */
    audiences;
    /** @type {Service|Service[]} service(s) on which context creation was attempted */
    #service;

    /**
     * 
     * @param {import("../../token/Token")} token 
     * @param {import("../../service/Service")} service 
     * @param {string} message 
     */
    constructor(token, service, message = `Token was issued for different audience(s) [${(token.audiences || []).join(", ")}] than this service (${service.credentials.clientid}).`) {
        super(token, message);
        this.name = "WrongAudienceError";
        this.service = service;
        this.audiences = token.audiences;
    }

    get service() {
        return this.#service;
    }

    set service(value) {
        this.#service = value;
    }
}

module.exports = WrongAudienceError;